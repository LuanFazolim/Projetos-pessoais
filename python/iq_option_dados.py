import pyodbc
#hora = ['20:40:0', '20:42:0', '20:44:0', '20:46:0', '20:48:0', '20:50:0', '20:52:0', '20:54:0', '20:56:0', '20:58:0', '21:0:0', '21:2:0', '21:4:0', '21:6:0', '21:8:0', '21:10:0', '21:12:0', '21:14:0', '21:16:0', '21:18:0', '21:20:0', '21:22:0', '21:24:0', '21:26:0', '21:28:0', '21:30:0', '21:32:0', '21:34:0', '21:36:0', '21:38:0', '21:40:0', '21:42:0', '21:44:0', '21:46:0', '21:48:0', '21:50:0', '21:52:0', '21:54:0', '21:56:0', '21:58:0', '22:0:0', '22:2:0', '22:4:0', '22:6:0', '22:8:0', '22:10:0', '22:12:0', '22:14:0', '22:16:0', '22:18:0', '22:20:0', '22:22:0', '22:24:0', '22:26:0', '22:28:0', '22:30:0', '22:32:0', '22:34:0', '22:36:0', '22:38:0', '22:40:0', '22:42:0', '22:44:0', '22:46:0', '22:48:0', '22:50:0', '22:52:0', '22:54:0', '22:56:0', '22:58:0', '23:0:0', '23:2:0', '23:4:0', '23:6:0', '23:8:0', '23:10:0', '23:12:0', '23:14:0']
#dinheiro = [[108349.0], [108357.0], [108372.0], [108392.0], [108419.0], [108451.0], [108485.0], [108493.0], [108535.0], [108519.0], [108524.0], [108527.0], [108525.0], [108523.0], [108532.0], [108551.0], [108538.0], [108522.0], [108538.0], [108517.0], [108481.0], [108461.0], [108447.0], [108453.0], [108434.0], [108508.0], [108510.0], [108507.0], [108507.0], [108501.0], [108508.0], [108495.0], [108517.0], [108499.0], [108538.0], [108557.0], [108537.35714285716], [108512.0], [108456.0], [108470.0], [108467.0], [108469.0], [108460.0], [108436.0], [108450.0], [108447.0], [108475.0], [108481.0], [108494.0], [108536.0], [108495.0], [108491.0], [108516.0], [108543.0], [108591.0], [108615.0], [108595.0], [108559.0], [108561.0], [108561.0], [108576.0], [108548.0], [108517.0], [108529.0], [108544.82196003401], [108526.0], [108538.0], [108599.0], [108556.0], [108560.0], [108540.0], [108535.0], [108506.0], [108485.0], [108461.0], [108492.0], [108488.0]] 
conn = pyodbc.connect(
    'DRIVER={ODBC Driver 17 for SQL Server};'
    'SERVER=DESKTOP-E5FJI7M;'
    'DATABASE=iq_option_sql;'
    'Trusted_Connection=yes;'
)
cursor = conn.cursor()
'''
q = "DELETE FROM dados_diarios"
cursor.execute(q)
# Query para adicionar valores
query = """
INSERT INTO dados_diarios (hora, lucro)
VALUES (?, ?)
"""

# Valores para inserir
for horas,dinheiros in zip(hora,dinheiro) :
    
    din = dinheiros[0]
    hrs = horas.split(':')
    hrs = int(hrs[0]) +(int(hrs[1])/60) + (int(hrs[2])/3600)
    print(hrs , din)
    
    cursor.execute(query, (hrs, din))'''
# Executando o comando
hora = []
din = []


select = 'SELECT * FROM dados_diarios'
cursor.execute(select)
for r in cursor.fetchall():
    hora.append([float(r[0])])
    din.append([float(r[1])])
print(hora,"\n",din)
# Confirmando as alterações
conn.commit()

print("Valores adicionados com sucesso!")

# Fechando a conexão
cursor.close()
conn.close()
